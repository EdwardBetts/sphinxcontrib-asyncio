sudo: no

language: python

python:
  - 3.5
  - 3.6
  - 3.7
  - 3.8

os:
  - linux
#  - osx

cache:
  directories:
  - $HOME/.cache/pip

before_cache:
  - rm -f $HOME/.cache/pip/log/debug.log

install:
  - pip install --upgrade pip wheel
  - pip install --upgrade setuptools
  - pip install flake8
  - pip install -e .

script:
  - flake8 sphinxcontrib
  - make doc
  - python setup.py check -rms


deploy:
  provider: pypi
  user: __token__
  password: $PYPI
  distributions: "sdist bdist_wheel"
  skip_existing: true
  on:
    tags: true
    all_branches: true
    python: 3.8
